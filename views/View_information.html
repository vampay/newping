<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

    <title>API Page</title>

    <link href="index.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/navber.css">
    <style>
        .activity-card {
            max-width: 300px;
            margin: 15px;
        }
        .card-content {
            padding: 15px;
        }
        .card-header {
            background-color: #008b56;
            color: white;
            padding: 10px;
        }
        .card-body {
            background-color: #F1F1F1;
            padding: 10px;
        }
        .card-body p {
            margin: 0;
            line-height: 1.6;
        }
        .find-product {
            text-align: right;
            margin-top: 10px;
        }
        .footer {
            background-color: #ffa600; /* สีเดียวกับ navbar */
            color: white;
            text-align: center;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        .full-width-image {
            width: 100%;
            height: auto; /* Ensure the aspect ratio is maintained */
        }
    </style>
  </head>
  <body>
    
    <!-- Navbar -->
    <div class="w3-bar navbar-logo">
        <!-- Logo on the left -->
        <div class="w3-bar-item">
          <a href="/homepage">
              <img src="/img/tsu.png" alt="Logo">
          </a>
          <!-- <a href="/HomepageAdmin" class="w3-button w3-white w3-border w3-round-large">แอดมิน</a> -->
        </div>

        <!-- Right buttons -->
        <div class="w3-bar-item navbar-buttons">
            <a href="/APIPage" class="w3-button w3-red w3-round-large">ประวัติของผู้ใช้งาน</a>
            <a href="/APIPage_show" class="w3-button w3-white w3-border w3-round-large">กิจกรรมที่ได้ลงไปแล้ว</a>
            <a href="/homepage" class="w3-button w3-white w3-border w3-round-large">กิจกรรมแนะแนวที่ลงได้</a>
            <a href="/" class="w3-button w3-white w3-border w3-round-large">ออกจากระบบ</a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
      <div class="d-flex bd-highlight mb-3">
        <div class="me-auto p-2 bd-highlight">
          <h2>Users</h2>
        </div>
        <!-- <div class="p-2 bd-highlight">
          <button type="button" class="btn btn-secondary" onclick="showUserCreateBox()">Create</button>
        </div> -->
      </div>

      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">ชื่อ นามสกุล</th>
              <th scope="col">วันที่เข้าร่วม</th>
              <th scope="col">ช่วงเวลา</th>
              <th scope="col">ที่ตั้ง</th>
              <th scope="col">จำนวนนักเรียน</th>
            </tr>
          </thead>
          <tbody id="mytableUser">
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- JavaScript to fetch and display data -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
          fetch('/api/school')
              .then(response => response.json())
              .then(data => {
                  const tableBody = document.getElementById('mytableUser');
                  tableBody.innerHTML = ''; // Clear existing content

                  data.forEach(row => {
                      const user = row.user || {}; // Handle case where user may not exist
                      const tr = document.createElement('tr');
                      
                      tr.innerHTML = `
                          <td>${user.name || ''} ${user.surname || ''}</td>
                          <td>${new Date(row.date).toLocaleDateString()}</td>
                          <td>${row.startTime} - ${row.endTime}</td>
                          <td>${row.location}</td>
                          <td>${row.student_count}</td>
                      `;
                      
                      tableBody.appendChild(tr);
                  });
              })
              .catch(error => console.error('Error fetching data:', error));
      });
    </script>

    <!-- Footer -->
    <div class="footer">
      <p>© 2024 All rights reserved</p>
    </div>
  </body>
</html>
